---
apiVersion: mongodb.com/v1
kind: MongoDB
metadata:
  name: my-replica-set
  namespace: mongodb
spec:
  members: 3
  version: 4.2.12-ent # 3.6.20-ent
  type: ReplicaSet
  opsManager:
    configMapRef:
      name: my-replica-set # Must match metadata.name in ConfigMap file
  credentials: mongodb-opsmanager-admin-key
  persistent: true
  podSpec:
    cpu: "0.5"
    # note: it's important to always specify memory otherwise wired tiger cache will be calculated incorrectly and
    # monitoring tools will report the size of Kubernetes node instead of the real size of the container
    memory: 500 Mi  # 2Gi
    persistence:
      single:
        storage: 1Gi # 2Gi
  security:
    certsSecretPrefix: mdb # provide custom x509 certificates (keys and certs)
    tls:
      enabled: true # false
      ca: ca-pem # provide a custom certificate authority (cert in a pem file)
      secretRef:
        prefix: mdb
        # name: mdb-my-replica-set-cert
    authentication:
      enabled : true # false
      modes: ["SCRAM"]
  # The default TLS mode is 'requireTLS' but it can be customized using the
  # the `additionalMongodConfig` structure. Please find more information here:
  # https://docs.mongodb.com/manual/reference/configuration-options/#net.ssl.mode
  # additionalMongodConfig:
  #   net:
  #     ssl:
  #       mode: "preferSSL" # "requireSSL" "preferSSL" "allowSSL"
